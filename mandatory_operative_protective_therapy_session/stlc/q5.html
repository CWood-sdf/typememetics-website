<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <style>
    body {
      background-color: black;
      color: #33ff33;
      font-family: monospace;
      padding: 20px;
      padding-top: 120px;
      font-size: 1.5em;
      line-height: 1.2;
    }

    #terminal {
      white-space: pre-wrap;
      overflow-wrap: break-word;
      border-left: 2px solid #33ff33;
      padding-left: 10px;
      animation: flicker 0.15s infinite alternate;
    }

    @keyframes flicker {
      0% { opacity: 1; }
      100% { opacity: 0.9; }
    }

    .cursor::after {
      content: "█";
      animation: blink 0.8s steps(1) infinite;
    }

    @keyframes blink {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }

    .button-container {
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-width: 800px;
    }

    .button-container button {
      position: relative;
      background: transparent;
      color: #33ff33;
      border: none;
      font-family: monospace;
      font-size: 1em;
      line-height: 1.2;
      padding: 4px 0;
      cursor: pointer;
      text-align: left;
      display: none;
    }

    .button-container button:hover {
      background: rgba(51,255,51,0.1);
    }

    .button-container button:focus {
      outline: none;
    }

    .button-container button:focus::after {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 1ch;
      height: 1em;
      background: currentColor;
      animation: blink 1s steps(1) infinite;
    }
  </style>
</head>
<body>
  <div id="terminal" class="cursor"></div>
  <br />
  <br />
  <div class="button-container">
    <button id="btn0" onclick="handle1()">1. ((A → B → C) → A → B) → (A → B → C) → A → C</button>
    <button id="btn1" onclick="handle2()">2. ((A → B) → A → B → C) → (A → B → C) → A → C</button>
    <button id="btn2" onclick="handle3()">3. ((A → B) → A → B) → (A → B → C) → A → C</button>
  </div>
  <script>
    const text = `Problem 5

Please take a look at the following STLC term:

      (λf.λg.λx.f (g x))(λf.λg.λx.f (g x))

Breathe in, breathe out. Focus.

What is a correct type for the term in an empty typing context?

... Press number 1, 2 or 3 to select your answer ...
`;
    const terminal = document.getElementById("terminal");
    let i = 0;
    const url = new URL(window.location.href);
    const tryStr = url.searchParams.get('try');
    const tryNum = parseInt(tryStr, 10);
    let fail = tryNum || 0;

    async function showButtons() {
      const buttons = document.querySelectorAll(".button-container button");
      for (const btn of buttons) {
        const fullText = btn.textContent;
        btn.textContent = "";
        btn.style.display = "block";
        for (let j = 0; j < fullText.length; j++) {
          btn.textContent += fullText.charAt(j);
          const charDelay = Math.random() * (35 - 15) + 15;
          await new Promise(res => setTimeout(res, charDelay));
        }
        await new Promise(res => setTimeout(res, 100));
      }
    }
    function handle1() {
      const message = { type: "NEXT", payload: { url: `q5.html?try=${++fail}` } };
      window.parent.postMessage(message, "*");
    }
    function handle2() {
      const message = { type: "NEXT", payload: { url: `end1.html` } };
      window.parent.postMessage(message, "*");
    }
    function handle3() {
      const message = { type: "NEXT", payload: { url: `q5.html?try=${++fail}` } };
      window.parent.postMessage(message, "*");
    }
    document.addEventListener("keydown", function(event) {
      switch (event.key) {
        case "1":
          handle1();
          break;
        case "2":
          handle2();
          break;
        case "3":
          handle3();
          break;
        default:
          break;
      }
    });
    function type() {
      if (i < text.length) {
        terminal.textContent += text.charAt(i);
        i++;
        const delay = Math.random() * (35 - 15) + 15;
        setTimeout(type, delay);
      } else {
        console.log("Typing complete");
        terminal.focus();
        terminal.classList.remove("cursor");
        showButtons();
      }
    }
    window.onload = type;
  </script>
</body>
</html>



